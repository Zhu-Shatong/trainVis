import plotly.graph_objects as go


def plot_rose():

    # 数据
    # data = {
    #     0: {0: 0, 45: 123, 90: 370, 135: 300, 180: 0, 225: 0, 270: 0, 315: 0},
    #     1: {0: 0, 45: 544, 90: 757, 135: 533, 180: 156, 225: 0, 270: 0, 315: 0},
    #     2: {0: 12, 45: 184, 90: 286, 135: 219, 180: 185, 225: 0, 270: 0, 315: 0},
    #     3: {0: 41, 45: 284, 90: 191, 135: 136, 180: 78, 225: 0, 270: 0, 315: 0},
    #     4: {0: 5, 45: 254, 90: 115, 135: 152, 180: 3, 225: 0, 270: 0, 315: 0},
    #     5: {0: 74, 45: 145, 90: 119, 135: 79, 180: 0, 225: 0, 270: 0, 315: 0},
    #     6: {0: 35, 45: 21, 90: 139, 135: 77, 180: 0, 225: 0, 270: 0, 315: 0},
    #     7: {0: 21, 45: 13, 90: 111, 135: 18, 180: 0, 225: 0, 270: 0, 315: 0},
    #     8: {0: 10, 45: 8, 90: 134, 135: 14, 180: 0, 225: 0, 270: 0, 315: 0}
    # }

    data = {0: {0: 0, 45: 124, 90: 365, 135: 288, 180: 16, 225: 0, 270: 0, 315: 0},
            1: {0: 8, 45: 761, 90: 527, 135: 538, 180: 156, 225: 0, 270: 0, 315: 0},
            2: {0: 26, 45: 198, 90: 256, 135: 221, 180: 185, 225: 0, 270: 0, 315: 0},
            3: {0: 43, 45: 295, 90: 176, 135: 137, 180: 79, 225: 0, 270: 0, 315: 0},
            4: {0: 5, 45: 256, 90: 102, 135: 146, 180: 20, 225: 0, 270: 0, 315: 0},
            5: {0: 87, 45: 176, 90: 74, 135: 80, 180: 0, 225: 0, 270: 0, 315: 0},
            6: {0: 35, 45: 32, 90: 128, 135: 77, 180: 0, 225: 0, 270: 0, 315: 0},
            7: {0: 21, 45: 15, 90: 109, 135: 18, 180: 0, 225: 0, 270: 0, 315: 0},
            8: {0: 10, 45: 42, 90: 100, 135: 14, 180: 0, 225: 0, 270: 0, 315: 0}}

    # 创建图表
    fig = go.Figure()

    # 添加每个层级的数据
    for i in range(9):
        name = f'{i*200}-{(i+1)*200} km'
        color = f'rgb({int(106+i*(136/8))},{int(81+i*(73/8))},{int(163+i*(84/8))})'
        r_values = [data[i][j] for j in range(0, 360, 45)]
        fig.add_trace(go.Barpolar(
            r=r_values,
            theta=['N', 'N-W', 'W', 'S-W', 'S', 'S-E', 'E', 'N-E'],
            name=name,
            marker_color=color
        ))

    # 更新图表布局
    fig.update_layout(
        title='上海出发高铁方向玫瑰图（仿风玫瑰图）',
        font_size=16,
        legend_font_size=16,
        height=900,
        polar_radialaxis_ticksuffix='%',
        polar_angularaxis_rotation=90
    )

    # 展示图表
    return fig


if __name__ == '__main__':
    plot_rose().show()
